NMAP
-You can run nmap with specific flags to enum whats inside of SMB. For example:
-nmap -sV -Pn -script smb-enum-shares <target_ip>
To check protocols
  -nmap -p 139,445 -sV --script=smb-protocols <target host>
To check everything
  -nmap -sS -sT -sV --script=smb-enum-sessions,smb-enum-shares,smb-enum-users,smb-os-discovery,smb-enum-services <target host>
HOW TO MOUNT A SMB FILE USING COMMAND LINE IN WINDOWS
-net use Z: \\<target_ip>\C$ <passwd> /user:<user_name>
AND TO REMOVE IT
-net use * /delete
VERSION DETECTION FOR SAMBA
-nmap --script smb-os-discovery.nse -p 445 <target_ip>

SMBMAP
To list shares run
  -smbmap -H [HOST] -u [USERNAME] -p [PASSWORD]
To execute a command
  -smbmap -H [HOST] -u [USERNAME] -p [PASSWORD] -x '<command>'
To list all drives
  -smbmap -H [HOST] -u [USERNAME] -p [PASSWORD] -x 'L'
To list contents of the directoyr of C:\ drive 
  -smbmap -H [HOST] -u [USERNAME] -p [PASSWORD] -r 'C$'
To upload a file
  -smbmap -H [HOST] -u [USERNAME] -p [PASSWORD] --upload '[path/to/file]' '[C$\filename]'
To download a file
  -smbmap -H [HOST] -u [USERNAME] -p [PASSWORD] --download 'C$\filename.txt\'
SMBCLIENT
to connect to a share using a username and password
-smbclient //<target_ip>/<name_of_share> -U <user_name>%<password> (this can also work without the password, and it will be prompted later)

RPCCLIENT
Its like smbclient, but more powerful and complex.
To find the SID of a certain user, use the following command
-rpcclient -U "<user>" -P "password" \\<target> -c "lookupname -s SID admin"

enum4linux

enum4linux is a tool for enumerating information from Windows and Samba systems. It is a Linux alternative to the Windows tool enum.exe. 
enum4linux is written in Perl and is basically a wrapper around the Samba tools smbclient, rpcclient, net and nmblookup.
USING enum4linux WITH CREDENTIALS
-enum4linux -r -u "<user_name>" -p "<password>" <target_ip>


CRACKING SMB PASSWORDS WITH MSFCONSOLE LOGIN  

-use auxiliary/scanner/smb/smb_login
-set PASSFILE /usr/share/wordlists/metasploit/unix_passwords.txt
-set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
-exploit

SAMBA PIPES
Samba pipes are a powerful feature of the Samba file sharing protocol. They allow for a variety of communication tasks to be performed between client and server systems.

Here are some examples of how Samba pipes are used:

When you use the smbclient command to download a file from a Samba share, the file is transferred over a Samba pipe.
When you use the lp command to print to a remote Samba printer, the print job is spooled to the Samba server over a Samba pipe.
When you use the smbpasswd command to change the password of a Samba user, the new password is sent to the Samba server over a Samba pipe.

 To identify what samba pipes are available, we will be using MSFCONOSLE
-use auxiliary/scanner/smb/pipe_auditor
